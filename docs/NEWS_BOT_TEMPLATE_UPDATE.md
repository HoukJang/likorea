# 뉴스봇 템플릿 시스템 업데이트 가이드

## 개요
뉴스봇 시스템이 업데이트되어 이제 모든 프롬프트가 프론트엔드에서 관리됩니다. 백엔드의 하드코딩된 프롬프트가 제거되고, 템플릿 변수 시스템이 도입되었습니다.

## 주요 변경사항

### 1. 템플릿 변수 시스템
뉴스봇 프롬프트에서 다음 템플릿 변수를 사용할 수 있습니다:

- `{CURRENT_DATE}` - 게시글 작성 시점의 날짜와 시간
- `{LOCATION}` - 사용자가 선택한 지역명 (예: "Great Neck · Manhasset")
- `{MONTH}` - 현재 월 (숫자)
- `{WEEK_OF_MONTH}` - 현재 월의 주차 (1-5)
- `{NEWS_DATA}` - 수집된 실제 뉴스 데이터

### 2. 기본 프롬프트
새로운 뉴스봇을 생성할 때 자동으로 설정되는 기본 프롬프트:

**시스템 프롬프트:**
```
당신은 롱아일랜드 한인 커뮤니티를 위한 뉴스 요약 전문가입니다.
실제 뉴스를 바탕으로 정확하고 신뢰할 수 있는 정보만 전달합니다.

응답 형식:
제목: [게시글 제목]
내용: [게시글 내용]
```

**유저 프롬프트:**
```
【현재 시각】 {CURRENT_DATE}

【요청 지역】 {LOCATION}

【작성 요청】
아래는 {MONTH}월 {WEEK_OF_MONTH}째주 {LOCATION} 지역의 실제 뉴스입니다.
각 뉴스를 상세하고 친근하게 요약하여 한인 커뮤니티 소식지 형식으로 작성해주세요.

{NEWS_DATA}

【응답 형식 - 매우 중요】
다음 형식을 정확히 지켜주세요:

제목: {MONTH}월 {WEEK_OF_MONTH}째주 {LOCATION} 한인 커뮤니티 주요 소식
내용: [위 지침에 따라 작성된 뉴스 요약 내용]

⚠️ 주의사항:
- "제목:" 과 "내용:" 레이블은 반드시 포함해주세요
- 제목은 한 줄로 작성해주세요
- 내용은 HTML 형식으로 작성해주세요 (문단은 <p> 태그 사용)
- 각 뉴스 소개 끝에 <a href="링크" target="_blank">[원문보기]</a> 형식으로 출처 링크를 포함해주세요
```

## 기존 뉴스봇 업데이트 방법

### 자동 업데이트
기존 뉴스봇들의 프롬프트를 일괄 업데이트하려면:

```bash
cd backend
node utils/updateNewsBotPrompts.js
```

이 스크립트는:
1. 모든 뉴스봇을 찾아서
2. 이미 템플릿 변수를 사용하는 봇은 건너뛰고
3. 아직 구형 프롬프트를 사용하는 봇들을 새로운 형식으로 업데이트합니다

### 수동 업데이트
1. 관리자 패널에서 봇 관리 페이지로 이동
2. 업데이트할 뉴스봇의 수정 버튼 클릭
3. 프롬프트가 자동으로 새로운 형식으로 표시됨
4. 필요시 커스터마이징 후 저장

## 커스터마이징 가이드

### 프롬프트 수정 시 주의사항
1. **템플릿 변수 유지**: `{NEWS_DATA}`, `{LOCATION}` 등의 변수는 반드시 포함해야 합니다
2. **응답 형식 준수**: "제목:" 과 "내용:" 레이블은 반드시 포함되어야 합니다
3. **HTML 태그 사용**: 내용은 HTML 형식으로 작성되어야 합니다

### 프롬프트 예시
지역별 특화 프롬프트:
```
【현재 시각】 {CURRENT_DATE}

【요청 지역】 {LOCATION}

{LOCATION} 지역은 한인 밀집 지역으로, 특히 한인 비즈니스와 교육 관련 뉴스에 
중점을 두어 작성해주세요.

{NEWS_DATA}

[나머지 형식은 동일]
```

## 문제 해결

### 봇이 작동하지 않는 경우
1. 봇 설정에서 프롬프트에 필수 템플릿 변수가 포함되어 있는지 확인
2. 특히 `{NEWS_DATA}`가 누락되면 뉴스 내용이 전달되지 않음

### 프롬프트 복구
실수로 프롬프트를 삭제한 경우:
1. 봇 타입을 다른 타입으로 변경 후 다시 'news'로 변경하면 기본 프롬프트가 복구됨
2. 또는 위의 기본 프롬프트를 복사하여 수동으로 입력

## 향후 계획
- 프롬프트 템플릿 라이브러리 제공
- 프롬프트 버전 관리 기능 추가
- A/B 테스팅을 위한 복수 프롬프트 관리